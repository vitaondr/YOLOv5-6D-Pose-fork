Bootstrap: docker
From: nvidia/cuda:11.2.2-cudnn8-devel-ubuntu20.04

%post
    export DEBIAN_FRONTEND=noninteractive
    apt-get update --fix-missing -y 
    apt-get install -y ffmpeg libsm6 libxext6 nano
    apt-get update --fix-missing -y
    apt-get install -y software-properties-common
    add-apt-repository ppa:deadsnakes/ppa -y
    apt-get update --fix-missing -y
    apt-get install -y python3.9 python3.9-dev python3.9-distutils git curl
    curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
    python3.9 get-pip.py
    pip3.9 install --upgrade pip

    pip3.9 install torch==1.9.1+cu111 torchvision==0.10.1+cu111 torchaudio==0.9.1 -f https://download.pytorch.org/whl/torch_stable.html
    
    pip3.9 install matplotlib==3.8.2 \
        numpy==1.26.2 \
        opencv_python==4.8.1.78 \
        Pillow==10.1.0 \
        protobuf==4.25.1 \
        PyYAML==6.0.1 \
        Requests==2.31.0 \
        scipy==1.11.4 \
        Cython==3.0.6 \
        scikit-image \
        coremltools==5.2.0 \
        lion_pytorch==0.1.2 \
        tqdm setuptools==58.1.0 \
        wandb \
        tensorboard==2.14.1 \
        tensorboardx>=2.1 \
        seaborn==0.13.0 \
        pandas==2.1.4

%environment
    export PATH="/usr/local/bin:$PATH"
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8

%runscript
    echo "Singularity container is ready!"
